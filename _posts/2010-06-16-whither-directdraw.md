---
layout: post
title: Whither DirectDraw?
date: 2010-06-16 15:10
author: Chuck Walbourn
comments: true
categories: [directx, dxsdk, windowssdk]
---
The <strong>DirectDraw</strong> API has been more or less deprecated for game developers since the release of <em>DirectX 9.0 SDK</em> back in 2002. The last time we shipped samples or documentation on <em>DirectDraw</em> dates back to the <em>DirectX 8.1 SDK</em>. Game developers looking to do 2D rendering should be using <em>Direct3D</em>, or on systems with DirectX 11 the <em>Direct2D </em>API could also be a good choice. The <em>DirectDraw</em> documentation can still be found on <a href="https://docs.microsoft.com/en-us/previous-versions/aa917136(v=msdn.10)">Microsoft Docs</a>. A few lingering issues, however, has kept the <em>DirectDraw</em> header and import library in the <em>DirectX SDK</em> for many long years...
<!--more-->

In the <strong>DirectX SDK (June 2010)</strong> release, the <code>DDRAW.H</code> and <code>DDRAW.LIB</code> files are no longer there. The <em>DirectDraw</em> header, <code>DDRAW.H</code>, is included with Visual Studio 2008 because it includes the Windows SDK 6.0A release, and is present in all the newer versions of the Windows SDK including the most recent 7.1 release. Because we do not officially support Visual Studio 2005 in the June 2010 release, we finally removed the header and import library. There are only two samples in the <em>DirectX SDK (June 2010) </em>that even need the <code>DDRAW.H</code> header: the rather dated <em>Direct3D </em>9 era sample <strong>ConfigSystem</strong> and the more recent sample <strong>VideoMemory</strong>. These compile fine with VS 2008 or VS 2010 due to the Windows SDK. It is worth noting, however, that the import library <code>DDRAW.LIB</code> is <em>not</em> present in the Windows SDK. It is therefore recommended that if you do make use of <em>DirectDraw</em>, you use explicit linking (i.e. ``LoadLibraryEx`` and ``GetProcAddress``) to get any <code>DDRAW.DLL</code> entry-points. This technique is used by these two samples.

These samples also highlight the one area of <em>DirectDraw </em>that game developers continue to make use of even in modern games: getting the amount of video memory on the graphics card. It turns out that this functionality is not available in the <em>Direct3D </em>9 API, so many game developers use <em>DirectDraw </em>just to get this information as part of their game configuration and user settings. There are some problems with this use, however, as noted in the <a href="https://github.com/walbourn/directx-sdk-samples/tree/master/VideoMemory">VideoMemory</a> sample. With the growth of physical memories both RAM and VRAM, this API is also having problems coping since it returns 32-bit DWORD counts of the size in bytes. <strong>It is recommended that when DXGI is available (Windows Vista, Windows 7, etc.), that is the most reliable API to use for getting video memory size information.</strong> For Windows XP, the Windows Management Instrumentation (WMI) interfaces are generally a better choice than <em>DirectDraw</em>, although this requires special-case logic on integrated graphics parts.

Another reason game developers continue to use the <code>DDRAW.H</code> header is that <em>DirectDraw</em>-era structures (<code>DDSURFACEDESC2</code> and <code>DDCAPS2</code>) are used to define the .DDS file format, a format which is still in use today for <em>Direct3D </em>11. Instead of using <code>DDRAW.H</code>, we recommend using more generic file-related structures if you have your own DDS codec. These structures are documented in the Windows DirectX graphics documentation in the <a href="https://docs.microsoft.com/en-us/windows/desktop/direct3ddds/dx-graphics-dds">DDS</a> Reference. You can also find a <code>DDS.H</code> header in several samples that defines these documented structures, notably <em>DDSWithoutD3DX </em>or <em>DDSWithoutD3DX11</em>. As of the DirectX SDK (June 2010) release, all samples that need DDS structures use <code>DDS.H</code> instead of <code>DDRAW.H</code>.

> You can find the latest version of ``DDS.H`` on [GitHub](https://github.com/Microsoft/DirectXTex/blob/master/DirectXTex/DDS.h)

While many legacy DirectX APIs were left behind in the 32-bit only world (<em>DirectPlay, DirectMusic</em> performance layer<em>, </em>etc.<em>)</em>, <em>DirectDraw </em>(or at least <code>DirectDraw7</code>) is available to x64 native applications.

In general for video processing it is recommended that you make use of <em>DirectShow</em> or <em>Windows Media Foundation</em>. For low-level video operations on Windows Vista and Windows 7, you can make use of the <a href="http://msdn.microsoft.com/en-us/library/aa965263.aspx">DXVA 2.0</a> API. On Windows XP, DXVA 1.0 is supported through VMR9 via <em>DirectShow</em>.

<strong>Update</strong>: I have made some improvements to the <em>DDSWithoutD3DX11 </em>sample and updated the <code>DDS.H</code> header since the June 2010 release. See my <a href="https://walbourn.github.io/ddswithoutd3dx-sample-update/">blog post</a> on this topic.
